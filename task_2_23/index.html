<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>task_2_23</title>
	<style>
	div { display: flex; padding: 10px; border: 1px solid #000; background-color: #fff; margin: 10px }
	#ctrl { width: 1000px; border: none; justify-content: center; }
	button { width: 100px; background-color: #fff; }
	select { width: 100px; }
	</style>
</head>
<body>
	<div id="root">ruru
		<div>pink
			<div>apple
				<div>bababa</div>
				<div>dog</div>
			</div>
			<div>fat
				<div>solid</div>
				<div>sala</div>
				<div>fake</div>
				<div>red</div>
			</div>
		</div>
		<div>blood
			<div>you
				<div>wind</div>
				<div>logic</div>
				<div>mouse</div>
			</div>
			<div>link
				<div>proud</div>
				<div>quit</div>
			</div>
			<div>low
				<div>no</div>
				<div>gap</div>
				<div>decoration</div>
				<div>new</div>
			</div>
		</div>
		<div>rap
			<div>aaa</div>
		</div>
	</div>
	<div id="ctrl">
		<button id="depth">深度优先遍历</button>
		<button id="level">广度优先遍历</button>
		<select name="time" id="time">
			<option value="200">快</option>
			<option value="400">中</option>
			<option value="600">慢</option>
		</select>
		<input type="text" id="search-text">
		<button id="depth-search">深度优先搜索</button>
		<button id="level-search">广度优先搜索</button>
	</div>
	<script>
	(function(){
		var tree = new Tree(document.querySelector("#root"));
		function Tree(node) {
			var _this = this;
			this.stack = [];
			this.node = node;
			this.have = false;
			this.reset = function(node){
				node.style.backgroundColor = "#fff";
				if(node.children.length > 0){
					for (var i = 0; i < node.children.length; i++) {
						this.reset(node.children[i]);
					}
				}
			}
			this.depth = function(node){
				this.stack.push(node);
				if(node.children.length > 0){
					for (var i = 0; i < node.children.length; i++) {
						this.depth(node.children[i]);
					}
				}
			}
			this.level = function(node){
				var temp = [];
				if(this.stack.length === 0){
					this.stack.push(node)
					this.arr = [];
					this.arr.push(node);
				}
				this.arr.forEach(function(data){
					Array.prototype.forEach.call(data.children,function(data){
						temp = temp.concat(data);
					})
				})
				if(temp.length === 0) return;
				this.stack = this.stack.concat(temp);
				this.arr = temp;
				this.level(this.arr);
			}
			this.animation = function(time,flag){
				this.reset(this.node);
				clearInterval(this.timer);
				var i = 0;
				this.timer = setInterval(function(){
					if(i === _this.stack.length){
						clearInterval(_this.timer);
						_this.stack[i-1].style.backgroundColor = "#fff";
						_this.stack = [];
						if(!_this.have){alert("没有找到")}
						_this.have = false;
						return;
					}
					if(i>0) _this.stack[i-1].style.backgroundColor = _this.uniqueColor;
					_this.stack[i].style.backgroundColor = "#00f";
					if(flag){
						if(document.getElementById("search-text").value === _this.stack[i].childNodes[0].wholeText.trim()){
							_this.stack[i].style.backgroundColor = "#f00";
							_this.uniqueColor = "#f00";
							_this.have = true;
						}else _this.uniqueColor = "#fff";
					}
					i++;
				},time)
			}
		}
		document.getElementById('depth').onclick = function(){
			tree.stack = [];
			tree.depth(tree.node);
			tree.animation(document.getElementById("time").value)
		}
		document.getElementById('level').onclick = function(){
			tree.stack = [];
			tree.level(tree.node);
			tree.animation(document.getElementById("time").value)
		}
		document.getElementById('depth-search').onclick = function(){
			if(document.getElementById("search-text").value.trim() === '') return;
			tree.stack = [];
			tree.depth(tree.node,true);
			tree.animation(document.getElementById("time").value,true)
		}
		document.getElementById('level-search').onclick = function(){
			if(document.getElementById("search-text").value.trim() === '') return;
			tree.stack = [];
			tree.level(tree.node,true);
			tree.animation(document.getElementById("time").value,true)
		}
	})()
	
	</script>
</body>
</html>